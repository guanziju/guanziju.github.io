<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="UCAS本科生CTF训练平台  diy-00 解题记录">
<meta property="og:type" content="article">
<meta property="og:title" content="diy-00">
<meta property="og:url" content="http://example.com/2022/05/06/2/index.html">
<meta property="og:site_name" content="关子雎">
<meta property="og:description" content="UCAS本科生CTF训练平台  diy-00 解题记录">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-05-05T16:00:00.000Z">
<meta property="article:modified_time" content="2022-05-08T03:15:25.471Z">
<meta property="article:author" content="关子雎">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2022/05/06/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>diy-00 | 关子雎</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">关子雎</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="download fa-fw"></i>资源</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/06/2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="关子雎">
      <meta itemprop="description" content="思想不受困于天堂，才能自由于尘世。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="关子雎">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          diy-00
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-05-06 00:00:00" itemprop="dateCreated datePublished" datetime="2022-05-06T00:00:00+08:00">2022-05-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-05-08 11:15:25" itemprop="dateModified" datetime="2022-05-08T11:15:25+08:00">2022-05-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF%E8%AE%B0%E5%BD%95/" itemprop="url" rel="index"><span itemprop="name">CTF记录</span></a>
                </span>
            </span>

          
            <div class="post-description">UCAS本科生CTF训练平台  diy-00 解题记录</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>算法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> mul</span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> Fraction</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">n_Choose_k</span>(<span class="params">n, k</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(reduce(mul, (Fraction(n-i, i+<span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k)), <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hamweight</span>(<span class="params">h, n</span>):</span><br><span class="line">    <span class="keyword">if</span> h &lt;= n:</span><br><span class="line">        H = []</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            r = random.randint(<span class="number">0</span>, n-<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="number">2</span>**r <span class="keyword">not</span> <span class="keyword">in</span> H:</span><br><span class="line">                H.append(<span class="number">2</span>**r)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(H) == h:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(H)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>(<span class="params">l</span>):</span><br><span class="line">    n = <span class="number">2</span> * random.randint(<span class="number">4</span> * l, <span class="number">5</span> * l) + <span class="number">1</span></span><br><span class="line">    p = (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        h = random.randint(<span class="number">1</span>, <span class="built_in">int</span>(math.sqrt(n) / <span class="number">2</span>) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> n_Choose_k(n-<span class="number">1</span>, h-<span class="number">1</span>) &gt;= <span class="number">2</span>**l:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    F, G = hamweight(h, n), hamweight(h, n)</span><br><span class="line">    pk = (F * inverse(G, p)) % p</span><br><span class="line">    sk = G</span><br><span class="line">    <span class="keyword">return</span> n, p, h, pk, sk</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg, h, pk</span>):</span><br><span class="line">    msg = <span class="built_in">bin</span>(bytes_to_long(msg))[<span class="number">2</span>:]</span><br><span class="line">    enc = []</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> msg:</span><br><span class="line">        A, B = hamweight(h, n), hamweight(h, n)</span><br><span class="line">        enc.append(<span class="built_in">int</span>(((-<span class="number">1</span>)**<span class="built_in">int</span>(b) * (A * pk + B)) % p))</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line">n, p, h, pk, sk = keygen(<span class="number">32</span>)</span><br><span class="line">ct = encrypt(FLAG, h, pk)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>((n, p, h, pk))</span><br><span class="line"><span class="built_in">print</span>(ct)</span><br></pre></td></tr></table></figure>

<p>数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(285, 62165404551223330269422781018352605012557018849668464680057997111644937126566671941631, 7, 50032280335353064063562141775452168306495006712801620800075628025420720550596143359136)</span><br><span class="line">[60461215610823330000250570419548979875444467351655244267422146173642151156863556855953, 17909907812452470441313234220378184471335524036880965857478650249880003844047116035398, 59833650193108834279715432968618499773104773687670885660415632385029469410169551401538, 54439033770410360358247882485590090564276630081531208808853617664984562628740074119727, 11816516730905169988151465935494425211889286888654091719746422999022442267869281980788, 29952084323460269168871053242444898751111428695031424639231747885601311534783736194263, 5585234000563164146526491159609412393140412783726093990354553446175237436236089435811, 2695202117550499024537275255644829567727416378405596218760568416437137459040444386544, 38580135535545729991538849567323614717766591158889240503407974457384125814936751835824, 36887382566625510700967775443053427101987723393774833429330007051201071369062276613954, 42520220330318753721090193383351276918142877972282677372131447494896774309998126813068, 53933138937854502798096952778741726838120780279639948416021891854060860954527391106348, 45260754242922497163996089448317941581879284755375796254870944042282623423546372501694, 21993145505903802263283039419375676885659708240418767994416730755551607214623384332454, 56373498381652887303113234127434745244863191379274003929335084360326112374003204809389, 1736203045212426941176084074145029784016040005918593139104354737853329883523215893409, 24333232349357738149473831120738059006260587690737330205623443085319066388018576721584, 4573401726448894705238726671875998295546291853248517636335619199777515648538295314962, 39921938480824798099769672637438535837142618658244437912973706485949451901947410960348, 36303754266755268820451886449218595607191435491278607913759807708776242644026105591067, 33043962474720368509364460072872709265708050894749265911746642486615378734584549587126, 23331048095846162359215914731240421003449490720507005063285534177120048765475742249183, 33486490990212729681586219387974908692082814249146415952229442441237576849454843788493, 6155241840651665869802339027346722385425296807329352915060989747060781640895300970909, 48900149376078362235495334896874612017892845637748559282134574944183669100831246759944, 38584015684960318944633725329220126495481494709837586991584262914370028173296962780280, 47043191049391005319219016123808467088120120236209947250505771633653560608827319465560, 6603755050784937369816710078316349250375414045080894446799280983818971820630078386, 39701089385124616103741030638743486437915520814255951737360039575383031944884728088730, 48688551775426547761969823031820588916967093159437214533233094470869757085392125789408, 20432603258640019654969093481378293182491013216157793506947036700690050334757494840651, 47605648178639920790296384435537736826438525000281898166163554064692592541115453258710, 44441450387316053805345844078443385898175230686084067221436485701167696329027103173921, 50762138867344989907169976174370700567063364301725344366736458807880297414998124909090, 41301709083970003656823478217578027864568043257409516934073524312286047644146811676781, 3658379365163787008650004343425505600173641133485181454940053811074000129282732345376, 25452698921882408381930495675178337081420016346744839593981983011867754478722167056913, 23574019607889129341262313145405961789673059029408025085063403481013760981092463321921, 3983528656858975029257604443993512849375878520939476904013589915268707375424686426338, 35931614970966263710436868786317919286415810973174495342936520692089968457862368169363, 38608594329919517599979830363564791544098277029374498956636969134817030403492504272002, 50474408541069850376608683076662558050016061417560719844330368840126509680758598708457, 7025340813298850349582452401733606753389895820676657059619777573772641892936034834331, 24207019560604271415942100206578162459541058899502485206808256537982903575626442390689, 51516314592574319288150386449514258294300757268792614534890691493599928728476617718108, 33606207023016567978187699375724132893254680800166796003993498188732125351047019766105, 56898611044445083441829011970576310658521920652907671143222892368599657304070103670552, 1551195551878798309997119027685209669612104395679238274491267833866490741229103138436, 15740254764574110710047350330267167052903270109168062954163545604648536177206260711337, 26968024264111118104974444946741834954543902032819018039511710484621655299152716744770, 10281376384640255006981482990525859058145420893381616672619556359483983467048171137011, 57173589519974336573006664848760559064725864239628234545850238700808392321704258676223, 29272446146559650673714646435075826265846100138741146828118979581480604619651501550627, 2280071223197542143151509927841056881913809457812693856266856427920116670948963331758, 41069249824508803618560143915285206395988987606696196812193356684546719438226382359570, 24628511193765703262740930259324229242801347508760444843487864871011510519407352503828, 53716790191305265074512998492083613635402375566715273329261092565321340915156691893401, 1357621952423985711552666983186981067029119574286283749626132773757016660595420182468, 24108711053162735089007686197138000164961674544837474269407521330150699802938241839871, 56763726360381458727408712732293639104269939803286848745826888684034742703631087538984, 35091238188018133950293719629198692291764275182003418199339893485563503789370447087368, 49808647187447619892599404795312927203210493058669709669620883266270984855091457923857, 89180347174438886099809639339308603139038698586469511622630395651426942663973900485, 1475345919111274178259574051148875039920562777463495265010173701979686509228146774258, 14577046987595670005602322698675945121202182567846029746572777026551439330634655330318, 6363680775368264881483155858751565241774478732280019301151581942189820572591859035393, 18225984784081115805118218974637822619803117712292605960233054223229882784957045118101, 15334762402645566479843503087123846401438073903404019092645761492204684830695461936534, 9185902802757387658642142892226204872529602731912406002709523239145806665539401287903, 41614883381054601861743042961617277343752293098506717837937626621426046126288416226580, 36714326058265689312299208770046767978262537381409039227900064545582620789954275518777, 49604508510039968418573202206585737181507385927389531967823195875768692254191856613886, 37719045140223951527155902248585168046121900560176880148198957450510358807799836508706, 203845972808840257888877915864744649103677047305127051755716191788821084681463555974, 60034402667681553804341684034021151471270456256107775227478606280518778083624726703321, 50066635671952588374819144078955986656642383046175195995413332727920146328891027150003, 47201894966476559425651029339940746908655682556379911452338573155364379681619669558045, 57736611841757518261291789268588337456942002635719059798624961990343390771448065868032, 5242831458161354855290122126911458283660894473871776582866891448460558101051473086316, 17003750639400409606638700522694210383261898564008943657376475830781342269265138296960, 25943085190253630234132194653974281780691185411359653661401488717480005264708148229338, 50811080492727283608272497731012123340526545954894674792323942172295772399196808714020, 56318413948756343384812136970735720066596925049990901140433948042142606074214922725420, 21486529369688983977237091412223335956416834663914952831004870518202401553954630551621, 1012679942055925219083650927103771352413407208940904845271071891043657835731041281490, 5609385259145868467736088108827377959718271118195393746846978641916504637291275072988, 8729063973772968337935172058800488816100735730155547961442704516287496890025143940195, 26639283096542585913213481430725316018796638022326388551734527828512725246016230402706, 41020980788624234011388492323727559943750718216665021323971222429728208836344844919701, 51790463157328367183323338206362183154153654249497449562527010827149807204834213762563, 55983768966757332678155736887066025304263649357054853785418269105092326303400666871500, 53092899650533213755255277627398216603003983368970267533268221171454334105346013038023, 41631062064560828951492294032105013966707034110686636515479667479148463605453535612048, 21724293613533842505777381580496213309740961534587834640875234814195919246435415950808, 60130426463677153491234052413179279639302727443847047168541856088144264207131783587605, 6043416368515430816018221591960570166455710371289802212765977280888401869769663265494, 2933453201922336815483824979804210342248392548687707727344099881555571481890369556902, 22214389556546903317348085943087059573726704190153403714035718191518639714220133275808, 18337144967628781975130092987828431116133965706168204325549022372604599923339130831407, 12960568339021383970621359070830962381383091354609381398997979609988795839610502223800, 35211753407640401956538380175380472342174194845236109208902455814375423122095643008713, 53013115662269949799228916614009769689762058722390821021143089355656733812733590496128, 52871897916596601618700337451233122333895309296426184297451745524728607711927724375514, 61048994366934847092838146566213700526207152333930694450162855531844299385939413479790, 21839605017425363095735665333625039850682455495270770697384118072156672553644414461424, 57594722664266604942131630278737944125280591321572451203757619361748581765070482709135, 18457620442588297120684316274389543999954083462238708168971015555825621126168256709116, 48229241180647613833563675812273888910897471970203381304932907336344080539546525127166, 16162325931785677416826874826662472800021702263403949679389165508620805513502014100097, 12101814175796887127261740011690454906994077875122829735465441679994685973556215391766, 11796870924145085946035179511721806259278305330872860768184238713221266006381268763934, 26448257861338379002108056485186999070210335776716802140984254537654342629223658623462, 2004001620163102486119380772299783235352047909132161037881290597045451364713561805030, 3681809612291584226424454706546658766488258270956237468723162941044777882211445124393, 1338988912740811331105973856954809421751744987877723968692677491191845870683307986805, 35056426713023914457765557785320123823184944498589465877631711599413270883913337455756, 13102968511604066579420446007094776237841271633561713215908796674685548987192545123531, 31828134445438089747841633665817512595774568591567137327865483416334292168688110071140, 15761513784747457340961184106846288439948352376635891982191657839647344096047615367973, 7269593836391674363774236161527748581611731980384869195356115462426533687372999119448, 38026966452307043529569396395927768231867951090315569097213803833293530331980155577535, 16549521724108115671901913087981914024317098473342416329274167738003076075026441028318, 7474748109618482148790499589145437021803734417879017948776871649313907178075278974850, 7281109888992595645346073113289193007400820090737755161862482545048911083404716312954, 59754246715259336370887076452866296220798483181805200218279899156150146673001941240490, 25604285555945957733666162137766119829824130445486211249187998311517000088387025061123, 589048959577588263616014520952912351926119740245909814053496707346328755564998881772, 27881345484478735528891690914256866246754506965494055583966278958748945472927259444175, 5172110379837831478115608514623187627958078642734202912392150903142408206630871504197, 31297919040164050383398514074077545699599607952367159197546412121308978917146243517724, 47226883286838454420707480592989048449448953786653300430356692212931820610278749862736, 13522653533789428514134447576787070694649161090227157946026326305383800741587032971276, 41967104952823845395062890721775417031489149916362287805155540442303880287730695901298, 10550570222738957515242356043416613321051741546736542565301655682120367076216842824479, 30780540275771228433070598490492698550327533974418059837786887818464190298108192969524, 57282983421657194334134164302872236431151427890989617411288799997126632401744838076741, 55602295530870201406247563575872978217125184037964100715869066408538466611011340615310, 48673546794291406774367364066821442374148094201408880942133310150032358306964126337890, 19650352843722601207317918302287096891058606963778222953225846684438599509735295441949, 56537079069763396741575805396313753292825519632657199932896078644256094825134547992972, 41164709467322574523073646683691380988527004590418835463358552698762958556857384145492, 15306949729618695973280284464603990557435603888691744982467607257512984785296245125505, 7989328461135478956157193495926599198166904829014870813387247908227499426634868361008, 14302463184575252586627657502153625686499201098728406520105876545744804711294138890187, 26098027251143550377050964858665292533215605491812568780746246357318537579145020192184, 11517957830945372964571278354907636494363863092653931407343593637107619282408838796043, 42109759118683900905954373092298651613621567490552823447140172776722791831375038138560, 29807295012146847196418580705250684125102986753024020665379325627290746482328232989812, 29869789679347990100301951316985936138974966220849509661040508795433509857557875283521, 3126591177602876480462215923690098755547244242360600494956408546543867865096822311651, 15617002715439777515522320353917301312466287906317721472993666946736033244418445271189, 58744821296090568792925455058245401965696216356367078435899771088629869579211388822004, 23863124139755493924930902139152426086567003399654227603035000567689540607028317866537, 7190679550245041474347279796200747356580028955996915966728530843997001525317351769222, 37413559331372514521324897073961245668411396449290753974022166577762503501555439298147, 25387367754496011529270676589170636897569289789318434392961413391639563727937244886017, 27822615822981442163800239189012479714496733045926838667781903784036265272920247135665, 11591908592844107087927825930722676377181097830502015923749951274039155975820707716096, 51805264266954690601290026208390908099032786028545132414565645405131763412405321274840, 36184164251121034957182808886327967306263133222197339714398913600428388723796369346252, 17695974092744701073976654933461308293575867859468511491862254041348940477250717369652, 30007908281912189733646286321716014536468419902400406845488698221266930695587569851399, 57633861765032456187143734417733803503125622758341538882132404859026219549802313338437, 55945937911459653093944758581727543935497284593989767817979004963778419449032137082858, 43788318551364484800727614806895517540233694213538139755144122694757386888323183501693, 11751353383894564274556893579309854597991034196947035982401140797733127854712348980067, 37791451372402402989168752456803288969563985050129063289512297504151080723714358230696, 50948977377928232387138801191546037214121483558043520759997664458804798012927482110171, 18448220985656568765053861323847617447329299705568446302336477448105922064911525827721, 61123541546764369773190690832866202869882667693091239660493494338760055873614758345673, 28885601423414545732588931636513080929159122679158443697574141294694217387026576995057, 36615907729409702076826019131564642649982488888035046987789236805824744127873696729104, 7292006006378466490413229499877426625299939883193486704564408507917388215748234480938, 6372700871154141849801113513573963123911121115255058361183488584129301424584346016571, 10313850449990890839200640083663288157931891856062891317322058396799884963643576788386, 39810071393313847549789141638678536931827869831317080854883891887122204432223984044840, 43798199912559323288450514104913328923400855501024518742588133094446648942028921743551, 26651560841037453399004831414425645186259320975524493589109381034057664288483641286809, 38098532696726626705766042588252151755837680793035453641145365660724399927471388381867, 9780294846929283308688801592165376366652765160300109403445581807174017907485028102837, 10010535380076735687364729817264826293202274439236222309993069385360284976858016016459, 56387546624069421937430235994781543651516306281477055042348148799810089156277705251852, 23741847950634175940609285225019585265829157596771168909033963652130599220674541326623, 50052386704549283010718033261724830145643004631711904658241844231124897882133644247225, 23180392337470087632802278699953076685271444036436070932318866837366561696393089832622, 4710516565992435780620072230116806653946607549972952889950085537350710825011259838019, 55497437536680828618086394720424275561198087912516149144481198813178189332310751803, 41299940991910033694206551357880572217553215976033976081048256920879360391364362976067, 13530389224816879043183365507793844659866861568780905281276284532131598225086448233930, 34617654806719518746281007468075648581461677450696663009989724216107056870324194857193, 27644334236804958749487978438721340277673067099789187851732648490574505494038434287721, 44140028222280292607978898672512962001704255859777286734409816761814309932935979649089, 8603421941541131187823072034147262328017735353790730812352652956082509486213405751521, 61979788192187323622707546845466412805465534374665667562083565961242656469078929094399, 18989761524658560334217880654674259809178041265374897113753942721789405732881130915978, 27041039782159730696237532262056540912373241048026397152179871509626576076399318906258, 6439063799914555712535569577881337262960336029986662488226928773183625576392160137132, 7840747667542644639071918213253612562691476851960654242312865298820607562406095527496, 10977340504933468309704485612915914280196869476508159393421975069329112785049250723464, 57962293927055943608626867290993956332920043588665537076899529150285594277582805750256, 46106715246964766006932105916999504476916297249890012619361090200424113880444441049467, 720717261569370997796029796634050588796236466563298483124772371842743139482743218979, 44234401307164946593724670553891000587298148607434931379244510218377200367757950041024, 24376676869648816123735441108249227103340111124995872281579979305836568387939016333990, 26927047383691165573239087723268522984508365183387114312404979661235534207885007164184, 15241169401454091685155246023268664626432809774594566887110157579784240544391325479329, 12155894993339367001545940739434303895993652724202673110191166937585198340341836170162, 1719388205834932832504492397121377245250842629540696808311334616137021361127807697313, 39435471078302666707071254609442305359062177807357534604558017273970444560667167580004, 36522372015167018838512505576917207074625040659993290999047153510701588860212473134573, 45227517590536693195207204861196439104278511428524677493483123345027441318183091755572, 12657096713053660854594029827027600762789325896846779699886120815548003517085143929011, 42969271594433573624760384752552996666323688499011571446723929789391122011978814762472, 4523814308703439904489753997235458891243781461582934287591963916024249063297431640294, 22025563025444131054891516786293671035383627218572799441517007735383459576055144038585, 53705907796263613777081808846225326056839278718906810869183443308897839797647541653718, 60376271619700758135830348414714334620535860273265451069777026900956080780998977842312, 26856168103090883436562592793489742094034928240427569421162529341528433542483453823398, 27033603414845512932882364479946378704878280073728988181144615162111900936675385235684, 23841797095782781779566385586972340885626177100000126378968126555374941206644007425680, 22489754927923687770285868422393118436695610304990241233589074000031980472120292598098, 58778798555071893069241013377284612967349497017432524784674296586572634771367506341842, 22957843362390319522108151511410631945009728965268278968559262149155533491238045753434, 37435147965879741705866525123004460800811172045237673645386376798272356969818051134280, 4837381380865431344572854861308304859413943833215685658064514431664800583121551899498, 41699791373288532454540527108598406405094160598181936641267181647985791266640963667778, 35791676980261163144381974960601190908326175441856530094561482085497913868630781306978, 6295660703256991114779204652275184766003422542178655316347069377162960952640601322664, 23319510827406779969341929577776129995966138742018120522245298645579879313430234502491, 30499284429011462507689473813939252507432917501715687268714564977603158207393051459584, 52590808056554492462386491314399939110636211641519371781934453626128532919988599502020, 15688577427366795294692517861797296829680872985542746139072800108545160412348092512713, 24454968474324822703918810941264790077696858356703402145778660327250108762597844660730, 45960198437441223437531247189842087592007499066508162153184515179126981328747925544692, 17481615780582954559187725753090089891207770724331494886517731095113267593186975519992, 50198335666583450898693441844380194334308388122160550865670141751183293440437386735035, 17311823885159880517384751025956519592124211628080375281485952599534257757136497109687, 59280325589341172050765521808031759211310095238899216648519349917243290836795368388639, 48123052332380052339505826358833936352363423613369148222883340780684792120689719820211, 39727131517328412795354627109724708790191783139406001647077947489057332300232176503051, 29022095201490126614416190617566097921141435437169100082468788592412366620221149125684, 41873186819916934601021833348213971453423997530369770729658933609666681497131721558289, 1460600219226770907145974345213826812716324255039394975026395599514912954016914202513, 51936250235847985592337022804814084125610666214601079138062832590077350059406809151865, 27724953576048984203178292520079755139198413437917186210843568759513731192027201897183, 42059624240743744184228633175772180676234737633821654408398525524962831729151680770882, 53072372094304297666442962409494785858146082079496206438397878915443255514877510329988, 59773935115291963977316184645517443277544047741053126307180684642331822413746817374177, 59844921721226920536363203806273226760506865698494614346645772177526856635876720479368, 11224375841609470085332533790212570896751076502570757049751097848052159600832328684727, 13033986644334405018321083730497614143436787408108647900391143158649751677809488305838, 36755766164760771909528200800669376114880502951637369353146767803032650301479682374101, 25841552130108853088421337770069380180211730940888599154458384663561561818148494374461, 38494159902256706768908208686829060907149814197188836138862710072528970501593093180865, 57800241320618719962304185549239761885338896702251409017662593058594893609737095385623, 2774174052930294419131476335163995369594293477283357885772556969382772665318940351306, 52169273883654802975989561873557207894711722176127969470252109851147564337861088294107, 61137813057133063283721938608345530522412608781544852082668070936991571455636541523534, 8097726593697416112843133250183714557842504676468698062358559509532910659816443030570, 36851924487600244425601486679298863107293381736882591844655067090592662153499412432124, 32532653725281692706906597940023063821932124789071945377961896380400855211544902170129, 23712829107151991656224346222193710226377132270772166916934993795512190084597873711358, 29051450783792895586287235766552420779590232710043644309976847073355812550280632592177, 4425904501804598770099702786594268550686457956417458121303598248568642163145829507740, 27459838774732560624833325035831378992280738278960264629374069352418680293891022098489, 5790008141942893249371509975039075957614572470946724267487298310515498854942522784184, 23384469777204002447515365119877912004036612681898849961271304808646713833606416118409, 54799551957145134881852478844437235514594411614237122251934176537044914655691004208980, 58071254777103542304348487769051976129308667522804573744427019764236561083005559170407, 33617370947581974127107454903262896430882971609611526398113549022846506183801015995191, 61576134613932731726897568166697090537883993560019577187027299525032175981948152020341, 43769913560145290370737254885168120726476505397358048333194200949952984508312630226936, 13733738589055198930833528056872357505548548283182773160275041880017156927946476135564, 60540164836217290103370684386564190446994470647806840095988866869905807800278161873821, 53149921387836621618573696102647517163913101120213267316407942181938522156498783947518, 60901108352438580532747737009821681637803778570738846730573222744696891673082149691187, 48774150287078885256657900027246843853820319287736128385565381936226265820089630206779, 7774258809160209970376039153653379244624610594757914859306980801246900552073138277350, 57793684165461551850210018589933660293977094223652589136920057563063577889867320594389, 53386234151461184805041784874344655863680441751772553068248911486381411252426783933614, 1403568164480229554460835797136454152989481502814379645807224685333097035715722607693, 57676590850463930114850855309155101242228472275533433220961241474336622535427801132913, 27529603873424561987769551710059311138915554142390315956296834888521263052476998013157, 39514627537373564420152937700771090617000606181277351267685939010238482371691361225522, 61412721459530623432482870699059756415458579122207463350395628051715148867624895221950, 10241451793146041086633028909852521208452980457325061388441665208762844778606351819044, 44294742244955162832685746162982741088067414023455827141369893584176800277880693796974, 7833490678060157284017583721498402730729393754476207301455598608837352235050355141614, 13667647436311292600858459955008928683940210436931466782140526974244692555144154778265, 19186551410081284763926750962307846608907363363972029484433786952444123248740599576396, 16289783212447411974594680684279216937992319803412881287707275064113853613798051411057, 26348970099026653812621811675961628931001621671880826181878314337058190753625842387978, 46230231271758982760804157399116602414068371316725323710125347042357227124092179176744, 18571357298754131366875840321503457730308296406486134007116233253095546519037172108456, 56008286530218410409795046760561434654654986195788120770207638215936841630509771376037, 31246192676989587945535808704245682760226880272276911098245859630527247213233001444799, 21338280950756897687856268370573441573847778880191184956474787940629761766594348960110, 11665111714362992299370542345192032341403218504789758223742170797918382647362166339954, 31804897936525300144499036828781677554434204680505698835120724802863001203488534684076, 37968665595652710791570932194899500735248822820081022033711350370281943264167090817370, 37071374153482442215478528303549313031150249007510190850611317084583028283621406603360, 35355490290524379572650737110129173452800718696166381142936447115259394143973306440403, 40275129060982105159232727903861653938095352934870073240608552106580349464147622256871, 15358678990766641941895525963101670999880045011210473186499585568618940520368050216585, 60360501845984520514095027259600482999334818579671515098227880813483204106428651104339, 36510150691106922809808545913773901759924358965544842813798148746704149043306651382848, 17062843599960002389964927729049568337920456626823683456699718317693772683009889275216, 17627187047634866673021411113041919988648994018810686903676834109013105642234772920622, 17320280558957889865791628745063305658352129163552521803184919243742154059692151971475, 45297169477315671844730673229615938018172229368483786098999297234790490075506719515600, 25021995392460840629714064283569734146019309266880756034056588503597831015020738277419, 13174579180330604174242220889065958381594821510996556505734092549996122984329582065628, 28031206791603257345815191737655446964214981794751532258803025702725595092186329863808, 42899029296528215555194530600771629908888169373938815655493669197138254446277552242442, 20675635010555158383647509416542513233168431342588096879848678469307818013259187662450, 60245938419745999882948420364525949335936487188126957984674014538646729446775437530337, 55546927345957116623309190419572871620864116621967170784125776434096554554171370681052, 8118780664592805319953071790388633345454091460600512672667459508090145734757992894862, 54301818967684121423054124530287366494011708629419113080310219375993882841458717909524, 16274037295296610479279684369673979341459631818427104756754372287324127243384112802963, 27890844069690572218209890416128877075597061880721809720475790928170357736568363625970, 12741613596224959145929637292335964631531995847696382032723946356226435301423073662195, 32607470968583639618990327409684454255241160134696872813720177761298558323567849266710, 58569755640140913467870588180039213050465604715683299925628504393559347312391966241943, 33773523803356060143794491079666985472748567325827989382981398564346890073305922275764, 42185942299618595517075815561999662532385007574718063859883448586943891616153780447028, 50733940383808057679710491502966477803232218441583428279767519868956866754122183617121, 21023919674297276866627835205160087740117334576722294213877227244566417547234189022209, 55290528861542549823924096367956692564742216454652090288049712819094082312279015533018, 52975877808531145852336285548989301183617796664957674451179000882174624659998458707985, 61560014678845577755419119390919015301467857037308616065902265326353823254323127315094, 60268396810460446578225596813580905667516152168597808117955065095108673355792862752027, 34657924279680354637273247399770587981306097113530324689804817950412464101152916427557, 61133623735515332885327118325631750514431568538698037973970672988282062110466086856328, 32954260988402275563068723480208916496561194418522252988345680552055649820329741489877, 61488969757035356481716566864475324816983815574192726179836089227713434519173143166500, 56359869276650040966162953154432377325962000970848921842290698325876367454984669714796, 5542745147026315851613470243502739079911638819744111588216266757583892956249128886171, 26473201440910607724674454006620676867231791010328775664461273605479747103755800138355, 31564431032522294172557695852314437176912458101329966500128882059031093415598614343845, 37423755869327246113687710796486468384724475471043310871412023918469861969224146086791, 41998858293994921915340715086518880252886154743281582046471411145611132169453029439848, 13950852837793942645054774889646099774984768133673064971697918287183850692918062755433, 34638674054457954748505874496939601422793787179471118556967729028771100031305174099284, 30065144448572078516171533314550117815736888647075907466053237850849206227321779826985, 53486657604867681456850075102753467661591346886045922454046427203112840534620084711701, 20066223104334417552368460479665826117697937871008868132687637104783276828628527056848, 50938455029466300504937430070495913081553581505565458782810556662487651023205754121780, 18218520233931098616199352822788223886858687589237755849615701630943635368983499197917, 42223073248978205667168446190360610560216189553835385323666273937578381050054679136069, 14831082919038617792567234032730760189859224373927816914446115995744164606762943223939, 18699872269750417725266020155777050487418002882195536591619426856802944724147277831313, 36443402717544504210335109779547804981213417040712518067737480300675697276127451505406, 20026567699778559000384347042895257519884110368108170429571242802618148297499757616828, 39292400759721037457864603437895809852008239020112690497111801050564070457237796973957, 48609150014233729093349254512792465851082875969744562217997375195830779789080768497740, 31501118138340168172078778375885756232427639634098140481438682434434643587261608603156, 60634923070880754291274833678619091714184054436765366134382245076423207396451876470368, 6362927739022796901295366363252255680118131280055760903051731459175638999545821027668, 17175391324716789821381125999397155054127713533840156593937977943676539994670038103141, 30668561188699527408546819295603570981855413879628276495286720344676359698176549692011, 19848444016356582558753652595031605077083404124674675346229231000539198204097248169926, 20374756428222374940970696808250867729104948053932944318461951886903399512661630906375, 40413420667058389998765905473092240742175043406796465353707372240824642948191045296775, 13576188260198878605151165130817216410117887849353707113745282746772531303200297608825, 38928965282893802770802407029011196203066026928284609081955369587878808150201027484408, 50141036547360941340894202870350521135014776807029377419068032437812960383551402417362, 8406720489374251485005400296882825269204164564815195875952580599707795757108563327506, 4197559872564347841252506118270677010539126291697091005227414303175818829952129885119, 9395130926989099019951429772804838481000464194274000405354997735548390643663334754497, 21721055368729834768554604497647037700691796730783998431757280087652516896011300724999, 24440182885522218380038500817024366163092029954067803412923677454798505209998692174257, 23507757166134515344976323038535327556093471347720324726935142873576046035399736657751, 4632155182778401572590898595583660210897985105578493927536198875382150560563388745900, 39772529318497983717072881587671864599457575748024191351446394842319593733642956208119, 30437694060758682052196196907637802306775290102964014881534548781239748624736997205177, 23786412403332186628410271144391375379158459257599034594260453033798750512699417031142, 50140993375430928763078318621770368731949979261626827649091315365559755237086544030845, 47709648876585337090978476264397197938011839827670397228242683258502923032037646049024, 15602883982742873929335006209314488477315803680846541293030235647124002427754599104017, 45280393728951387611117663939324224257297470048958485741361996990905497875681068376142, 57540599362827901609082936607271688126763047376101315951016157787306276257993022687107, 446041756187034731796183600090839664367044000970986993511824695655775154152026720716, 17207393505458204381844699621729899806824665949994050009364716367089865440826339242000, 13655994993025759505238093032658735091511179661460067363858612982345542765251712952094, 5448467727024049103085331379131070075175704603370799379947468536565148381117807488869, 8585353569904189133089031525611081479857199158767217412953529866977640996642656733445, 40025888855199867884228967992629994446968553365400087481750649033140866755945616293624, 56492562129062886727355470112487162718647769563931379644793358200474411629391287539089, 34843262452412047849367066985975517929095625595959168656601386247343772003227224122552, 43472292688262791304286770422789809165226634904496613376890702032659089362442099687867, 28108870043768408366621723183948679947139339288166921671733191680242087761311094767506, 11860092646620002188711758395647937618195956146414373772971055491353372466474121971706, 50182076716493531991490169840926807501155708042368759676546525605562757964269149524473, 20158806501427016701277032988835220082317061042791783693475244059525140059223580344871, 10906348548153881372322119378839455492186759765749667907782122884398917068628114232836, 17883843633036348010935051913529460830448034777773871449455789767144818589334545806369, 43641909026764239160679603500912320539043859012239766645295333215024739647563248113766, 17811317689552543151146426942262816178909705734396636836771269174155564199312301843463, 4268895426070739086701460181999537234991159740305384564711061096590793222513955409129, 59663916901409855870525776251750927554382495008651376568169128816272531514063684819919, 49785282927002529597846208139824316276055935359746458422088154333398775682679211445967, 18272873284458123079383944887037566475069217942761020175398035622914974165856862453482, 61870830380702953483316087293568067010715181006520236043899379798938564802885141479294, 25249856786817927558900924893222488192657655286062668931777467386785708851270683126549, 36421987379700451698202120428765954664946364148517854002198139880469718188116864499541, 25576537303840822838914957090627185045497722426577577911567830916214528320779028728686, 9778226290758212397709746305894057434459717166840125068605958133356356063102137000424, 28122448653574900115388230742524740444101668679636502085203071302995928401879570028839, 25649438823227023978302326420944776219296934264042550451819812982910685314474572781300, 52986133545590833014706786644105933409879534960900382090571553443816529494830443286878, 4365926893046708100746769103517215948737335288905734292256672011713857797237484505675, 19017991403846416091129668449002223588062320907194545883131061749720121137626304877971, 22784701079299378184061531498711811645369112601131546132608596916712991157766440175483, 4022511320837068117151240260521597777929807139640896922787608423186138691601715229435, 47633804623803937111516510535752429675078590053963940214104638264486270365424656317300, 8905106153912819265930295910495192384806802996782398375282219995540706642696599777262, 17218514545115032883901318973151469572326189992018121232027774880615866622056142691747, 12141009964798632014868554985902271561652565922887513643276231680649427780830762177378, 23050892278329442825512503955464957953213174612492874728014916308906017677408172407680, 22564022078367679183538556138282392680731851229496296642914777305202960191437086384753, 33766230689170670304776831794171884225085416600985499359171340336183006959709744990235, 1003224574318836390916037938116685726518133030687840972457966531788921640943579230529, 57727426217391042242069278864279411759641399690733361874342894904779912585697146562799, 14418514064236263180532416987880726815963677820125524758404460840597620976392172017890, 30537358294095885301649532337156012844654246000941721904043153024204439209542957854284, 17777662281041808896529752305918035918475001875820511719086869296564920052586999882578, 29202616590531416733490202288646484129369661216877223877720060827086488639409524318554, 47670113578465654035010280027746524149713635984846572400146540482880881299646442070647, 18959898649460639462254582857258182743203119545929005128034326022519296081727139809886, 36921585211024475101980361950533617186951403966711300775389954657808183355063447566515]</span><br></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>只要通过pk求出sk的值就可以解决问题。（sk&#x3D;G）</p>
<p>推导公式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pk = (F * G_inverse_p) % p</span><br><span class="line">(pk * G) % p = F</span><br><span class="line">((pk * G) % p) % p_sub = F % p_sub</span><br><span class="line">(pk * G) % p_sub = F % p_sub</span><br><span class="line">((pk % p_sub) * (G % p_sub)) % p_sub = F % p_sub</span><br><span class="line">注：</span><br><span class="line">G的模p逆元：G_inverse_p</span><br><span class="line">p_sub：p的因子</span><br></pre></td></tr></table></figure>

<p>可以发现，模形如(2^n-1)的数时，相当于在二进制下，将数字每n位截断，并将各段相加。这样的操作使得数字的二进制表示中的1的个数不会增加。题目中n &#x3D; 285，p &#x3D; 2^285-1，p有形如(2^n-1)的因子(2^3-1)，(2^5-1)，(2^15-1)，(2^19-1)，(2^57-1)，(2^85-1)。</p>
<p>(pk % p_sub)可以通过计算求得，(G % p_sub)和(F % p_sub)的二进制表示中1得个数不超过7。通过穷举所有二进制表示中1得个数不超过7的(G % p_sub)，找到所有使得(F % p_sub)的二进制表示中1得个数不超过7的(G % p_sub)。再根据二进制下所含1的个数对(G % p_sub)分类。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">pk = <span class="number">50032280335353064063562141775452168306495006712801620800075628025420720550596143359136</span></span><br><span class="line">pk2 = pk % (<span class="number">2</span> ^ <span class="number">57</span> - <span class="number">1</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">num</span>(<span class="params">i</span>) :</span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i != <span class="number">0</span> :</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2</span> :</span><br><span class="line">            k = k + <span class="number">1</span></span><br><span class="line">        i = i // <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> k</span><br><span class="line">s7 = []</span><br><span class="line">s6 = []</span><br><span class="line">s5 = []</span><br><span class="line">s4 = []</span><br><span class="line">s3 = []</span><br><span class="line">s2 = []</span><br><span class="line">s1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">57</span>) :</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i) :</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(j) :</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(k) :</span><br><span class="line">                <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(l) :</span><br><span class="line">                    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(m) :</span><br><span class="line">                        <span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(n) :</span><br><span class="line">                            w = (<span class="number">1</span> &lt;&lt; i) + (<span class="number">1</span> &lt;&lt; j) + (<span class="number">1</span> &lt;&lt; k) + (<span class="number">1</span> &lt;&lt; l) + (<span class="number">1</span> &lt;&lt; m) + (<span class="number">1</span> &lt;&lt; n) + (<span class="number">1</span> &lt;&lt; o)</span><br><span class="line">                            <span class="keyword">if</span>(num((pk2 * w) % (<span class="number">2</span> ^ <span class="number">57</span> - <span class="number">1</span>)) &lt;= <span class="number">7</span>) :</span><br><span class="line">                                s7.append(w)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">57</span>) :</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i) :</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(j) :</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(k) :</span><br><span class="line">                <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(l) :</span><br><span class="line">                    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(m) :</span><br><span class="line">                        w = (<span class="number">1</span> &lt;&lt; i) + (<span class="number">1</span> &lt;&lt; j) + (<span class="number">1</span> &lt;&lt; k) + (<span class="number">1</span> &lt;&lt; l) + (<span class="number">1</span> &lt;&lt; m) + (<span class="number">1</span> &lt;&lt; n)</span><br><span class="line">                        <span class="keyword">if</span>(num((pk2 * w) % (<span class="number">2</span> ^ <span class="number">57</span> - <span class="number">1</span>)) &lt;= <span class="number">7</span>) :</span><br><span class="line">                            s6.append(w)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">57</span>) :</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i) :</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(j) :</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(k) :</span><br><span class="line">                <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(l) :</span><br><span class="line">                    w = (<span class="number">1</span> &lt;&lt; i) + (<span class="number">1</span> &lt;&lt; j) + (<span class="number">1</span> &lt;&lt; k) + (<span class="number">1</span> &lt;&lt; l) + (<span class="number">1</span> &lt;&lt; m)</span><br><span class="line">                    <span class="keyword">if</span>(num((pk2 * w) % (<span class="number">2</span> ^ <span class="number">57</span> - <span class="number">1</span>)) &lt;= <span class="number">7</span>) :</span><br><span class="line">                        s5.append(w)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">57</span>) :</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i) :</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(j) :</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(k) :</span><br><span class="line">                w = (<span class="number">1</span> &lt;&lt; i) + (<span class="number">1</span> &lt;&lt; j) + (<span class="number">1</span> &lt;&lt; k) + (<span class="number">1</span> &lt;&lt; l)</span><br><span class="line">                <span class="keyword">if</span>(num((pk2 * w) % (<span class="number">2</span> ^ <span class="number">57</span> - <span class="number">1</span>)) &lt;= <span class="number">7</span>) :</span><br><span class="line">                    s4.append(w)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">57</span>) :</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i) :</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(j) :</span><br><span class="line">            w = (<span class="number">1</span> &lt;&lt; i) + (<span class="number">1</span> &lt;&lt; j) + (<span class="number">1</span> &lt;&lt; k)</span><br><span class="line">            <span class="keyword">if</span>(num((pk2 * w) % (<span class="number">2</span> ^ <span class="number">57</span> - <span class="number">1</span>)) &lt;= <span class="number">7</span>) :</span><br><span class="line">                s3.append(w)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">57</span>) :</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i) :</span><br><span class="line">        w = (<span class="number">1</span> &lt;&lt; i) + (<span class="number">1</span> &lt;&lt; j)</span><br><span class="line">        <span class="keyword">if</span>(num((pk2 * w) % (<span class="number">2</span> ^ <span class="number">57</span> - <span class="number">1</span>)) &lt;= <span class="number">7</span>) :</span><br><span class="line">            s2.append(w)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">57</span>) :</span><br><span class="line">        w = (<span class="number">1</span> &lt;&lt; i)</span><br><span class="line">        <span class="keyword">if</span>(num((pk2 * w) % (<span class="number">2</span> ^ <span class="number">57</span> - <span class="number">1</span>)) &lt;= <span class="number">7</span>) :</span><br><span class="line">            s1.append(w)</span><br><span class="line"><span class="built_in">print</span>(s7)</span><br><span class="line"><span class="built_in">print</span>(s6)</span><br><span class="line"><span class="built_in">print</span>(s5)</span><br><span class="line"><span class="built_in">print</span>(s4)</span><br><span class="line"><span class="built_in">print</span>(s3)</span><br><span class="line"><span class="built_in">print</span>(s2)</span><br><span class="line"><span class="built_in">print</span>(s1)</span><br></pre></td></tr></table></figure>
<p>运行此段程序会花费较长时间（约两个小时），可以得到全部可能的(G % p_sub)。可以发现，这些(G % p_sub)全部都二进制表示下含有7个1。</p>
<p>接下来我们通过(G % p_sub)来求得G。</p>
<p>推导公式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pk = (F * G_inverse_p) % p</span><br><span class="line">(pk * G) % p = F</span><br></pre></td></tr></table></figure>

<p>模(2^57-1)的数时，相当于在二进制下，将数字每57位截断，构成5个分段，并将各段相加。二进制表示下1的个数未发生变化，说明将各段相加时，无处在相同位置的1而导致进位。因此可以认为，每一个1都来自某一分段。<br>对每一种可能的(G % p_sub)，穷举其7个1分别独立地来自不同的段可能构成的G，找到所有使得F的二进制表示中1的个数为7的G。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">s7 = [<span class="number">39719925187073</span>, <span class="number">70919037911329</span>, <span class="number">79439850374146</span>, <span class="number">141012442022017</span>, <span class="number">141838075822658</span>, <span class="number">158879700748292</span>, <span class="number">281552554689537</span>, <span class="number">282024884044034</span>, <span class="number">283676151645316</span>, <span class="number">317759401496584</span>, <span class="number">563105109379074</span>, <span class="number">564049768088068</span>, <span class="number">567352303290632</span>, <span class="number">635518802993168</span>, <span class="number">1126210218758148</span>, <span class="number">1127001566545921</span>, <span class="number">1128099536176136</span>, <span class="number">1134704606581264</span>, <span class="number">1271037605986336</span>, <span class="number">2252420437516296</span>, <span class="number">2254003133091842</span>, <span class="number">2256199072352272</span>, <span class="number">2269409213162528</span>, <span class="number">2542075211972672</span>, <span class="number">4504840875032592</span>, <span class="number">4505815847305225</span>, <span class="number">4508006266183684</span>, <span class="number">4512398144704544</span>, <span class="number">4538818426325056</span>, <span class="number">5084150423945344</span>, <span class="number">9009681750065184</span>, <span class="number">9011631694610450</span>, <span class="number">9016012532367368</span>, <span class="number">9024796289409088</span>, <span class="number">9077636852650112</span>, <span class="number">10168300847890688</span>, <span class="number">18019363500130368</span>, <span class="number">18023263389220900</span>, <span class="number">18032025064734736</span>, <span class="number">18049592578818176</span>, <span class="number">18155273705300224</span>, <span class="number">18577625490395137</span>, <span class="number">20336601695781376</span>, <span class="number">36038727000260736</span>, <span class="number">36046526778441800</span>, <span class="number">36064050129469472</span>, <span class="number">36099185157636352</span>, <span class="number">36310547410600448</span>, <span class="number">37155250980790274</span>, <span class="number">40673203391562752</span>, <span class="number">72077454000521472</span>, <span class="number">72093053556883600</span>, <span class="number">72128100258938944</span>, <span class="number">72198370315272704</span>, <span class="number">72621094821200896</span>, <span class="number">74310501961580548</span>, <span class="number">81346406783125504</span>]</span><br><span class="line">s_array = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> s7 :</span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    array = []</span><br><span class="line">    <span class="keyword">while</span>(item != <span class="number">0</span>) :</span><br><span class="line">        <span class="keyword">if</span>(item % <span class="number">2</span> == <span class="number">1</span>) :</span><br><span class="line">            array.append(k)</span><br><span class="line">        item = <span class="built_in">int</span>(item // <span class="number">2</span>)</span><br><span class="line">        k = k + <span class="number">1</span></span><br><span class="line">    s_array.append(array)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> s_array :</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>) :</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>) :</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>) :</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>) :</span><br><span class="line">                    <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>) :</span><br><span class="line">                        <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>) :</span><br><span class="line">                            <span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>) :</span><br><span class="line">                                w = (<span class="number">1</span> &lt;&lt; (array[<span class="number">0</span>] + i * <span class="number">57</span>)) + (<span class="number">1</span> &lt;&lt; (array[<span class="number">1</span>] + j * <span class="number">57</span>)) + (<span class="number">1</span> &lt;&lt; (array[<span class="number">2</span>] + k * <span class="number">57</span>)) + (<span class="number">1</span> &lt;&lt; (array[<span class="number">3</span>] + l * <span class="number">57</span>)) + (<span class="number">1</span> &lt;&lt; (array[<span class="number">4</span>] + m * <span class="number">57</span>)) + (<span class="number">1</span> &lt;&lt; (array[<span class="number">5</span>] + n * <span class="number">57</span>)) + (<span class="number">1</span> &lt;&lt; (array[<span class="number">6</span>] + o * <span class="number">57</span>))</span><br><span class="line">                                <span class="keyword">if</span>(num((w * pk) % (<span class="number">2</span> ^ <span class="number">285</span> - <span class="number">1</span>)) == <span class="number">7</span>) :</span><br><span class="line">                                    <span class="built_in">print</span>(w)</span><br></pre></td></tr></table></figure>

<p>得到的可能的G有5个，分别设为G1，G2，G3，G4，G5。此时还不知道哪一个时真正的私钥，所以都对其作为可能的私钥进行尝试。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">G1 = <span class="number">26959946670289190662360377769682723956428938373613435757323112941568</span></span><br><span class="line">G2 = <span class="number">3885337784903770990422193415896450497301558451403921659857251758607030452721125687296</span></span><br><span class="line">G3 = <span class="number">463168356950107280027632399024915506756821837577313919502380370872762922696704</span></span><br><span class="line">G4 = <span class="number">121416805764108282612451082527048572675273421326878132984455361456779302562581970944</span></span><br><span class="line">G5 = <span class="number">31082761561162238064135836569685418790309911358457939902958099559429653763508228063232</span></span><br></pre></td></tr></table></figure>

<p>此加密方案将明文的每一个比特都加密为一个整数。当比特为0时，加密结果ct_0 &#x3D; ((A * pk + B) % p)，当比特为0时，加密结果ct_1 &#x3D; (p - ((A * pk + B) % p))。</p>
<p>推导公式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    (ct_0 * sk) % p</span><br><span class="line">= (((A * pk + B) % p) * sk) % p</span><br><span class="line">= (A * pk * sk + B * sk) % p</span><br><span class="line">= (A * F + B * G) % p</span><br><span class="line">    (ct_1 * sk) % p</span><br><span class="line">= p - ((A * F + B * G) % p)</span><br></pre></td></tr></table></figure>

<p>(A * F + B * G) % p的二进制表示中，1的个数不超过2 * (h ^ 2)。h的值不超过sqrt(n) &#x2F; 2 - 1，故(A * F + B * G) % p的二进制表示中，1的个数不超过n &#x2F; 2 - sqrt(n) + 2，即不超过n &#x2F; 2。<br>p - ((A * F + B * G) % p)的二进制表示中，1的个数不少于n &#x2F; 2 + sqrt(n) - 2，即不少于n &#x2F; 2。</p>
<p>可知解密方法为，将密文中的每一个整数乘以私钥sk，再模p，统计其二进制中1的个数，多于一半的判定其对应的明文比特为1，少于其一半的判定其对应的明文比特为0，进而可以得到明文。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">k = [60461215610823330000250570419548979875444467351655244267422146173642151156863556855953, 17909907812452470441313234220378184471335524036880965857478650249880003844047116035398, 59833650193108834279715432968618499773104773687670885660415632385029469410169551401538, 54439033770410360358247882485590090564276630081531208808853617664984562628740074119727, 11816516730905169988151465935494425211889286888654091719746422999022442267869281980788, 29952084323460269168871053242444898751111428695031424639231747885601311534783736194263, 5585234000563164146526491159609412393140412783726093990354553446175237436236089435811, 2695202117550499024537275255644829567727416378405596218760568416437137459040444386544, 38580135535545729991538849567323614717766591158889240503407974457384125814936751835824, 36887382566625510700967775443053427101987723393774833429330007051201071369062276613954, 42520220330318753721090193383351276918142877972282677372131447494896774309998126813068, 53933138937854502798096952778741726838120780279639948416021891854060860954527391106348, 45260754242922497163996089448317941581879284755375796254870944042282623423546372501694, 21993145505903802263283039419375676885659708240418767994416730755551607214623384332454, 56373498381652887303113234127434745244863191379274003929335084360326112374003204809389, 1736203045212426941176084074145029784016040005918593139104354737853329883523215893409, 24333232349357738149473831120738059006260587690737330205623443085319066388018576721584, 4573401726448894705238726671875998295546291853248517636335619199777515648538295314962, 39921938480824798099769672637438535837142618658244437912973706485949451901947410960348, 36303754266755268820451886449218595607191435491278607913759807708776242644026105591067, 33043962474720368509364460072872709265708050894749265911746642486615378734584549587126, 23331048095846162359215914731240421003449490720507005063285534177120048765475742249183, 33486490990212729681586219387974908692082814249146415952229442441237576849454843788493, 6155241840651665869802339027346722385425296807329352915060989747060781640895300970909, 48900149376078362235495334896874612017892845637748559282134574944183669100831246759944, 38584015684960318944633725329220126495481494709837586991584262914370028173296962780280, 47043191049391005319219016123808467088120120236209947250505771633653560608827319465560, 6603755050784937369816710078316349250375414045080894446799280983818971820630078386, 39701089385124616103741030638743486437915520814255951737360039575383031944884728088730, 48688551775426547761969823031820588916967093159437214533233094470869757085392125789408, 20432603258640019654969093481378293182491013216157793506947036700690050334757494840651, 47605648178639920790296384435537736826438525000281898166163554064692592541115453258710, 44441450387316053805345844078443385898175230686084067221436485701167696329027103173921, 50762138867344989907169976174370700567063364301725344366736458807880297414998124909090, 41301709083970003656823478217578027864568043257409516934073524312286047644146811676781, 3658379365163787008650004343425505600173641133485181454940053811074000129282732345376, 25452698921882408381930495675178337081420016346744839593981983011867754478722167056913, 23574019607889129341262313145405961789673059029408025085063403481013760981092463321921, 3983528656858975029257604443993512849375878520939476904013589915268707375424686426338, 35931614970966263710436868786317919286415810973174495342936520692089968457862368169363, 38608594329919517599979830363564791544098277029374498956636969134817030403492504272002, 50474408541069850376608683076662558050016061417560719844330368840126509680758598708457, 7025340813298850349582452401733606753389895820676657059619777573772641892936034834331, 24207019560604271415942100206578162459541058899502485206808256537982903575626442390689, 51516314592574319288150386449514258294300757268792614534890691493599928728476617718108, 33606207023016567978187699375724132893254680800166796003993498188732125351047019766105, 56898611044445083441829011970576310658521920652907671143222892368599657304070103670552, 1551195551878798309997119027685209669612104395679238274491267833866490741229103138436, 15740254764574110710047350330267167052903270109168062954163545604648536177206260711337, 26968024264111118104974444946741834954543902032819018039511710484621655299152716744770, 10281376384640255006981482990525859058145420893381616672619556359483983467048171137011, 57173589519974336573006664848760559064725864239628234545850238700808392321704258676223, 29272446146559650673714646435075826265846100138741146828118979581480604619651501550627, 2280071223197542143151509927841056881913809457812693856266856427920116670948963331758, 41069249824508803618560143915285206395988987606696196812193356684546719438226382359570, 24628511193765703262740930259324229242801347508760444843487864871011510519407352503828, 53716790191305265074512998492083613635402375566715273329261092565321340915156691893401, 1357621952423985711552666983186981067029119574286283749626132773757016660595420182468, 24108711053162735089007686197138000164961674544837474269407521330150699802938241839871, 56763726360381458727408712732293639104269939803286848745826888684034742703631087538984, 35091238188018133950293719629198692291764275182003418199339893485563503789370447087368, 49808647187447619892599404795312927203210493058669709669620883266270984855091457923857, 89180347174438886099809639339308603139038698586469511622630395651426942663973900485, 1475345919111274178259574051148875039920562777463495265010173701979686509228146774258, 14577046987595670005602322698675945121202182567846029746572777026551439330634655330318, 6363680775368264881483155858751565241774478732280019301151581942189820572591859035393, 18225984784081115805118218974637822619803117712292605960233054223229882784957045118101, 15334762402645566479843503087123846401438073903404019092645761492204684830695461936534, 9185902802757387658642142892226204872529602731912406002709523239145806665539401287903, 41614883381054601861743042961617277343752293098506717837937626621426046126288416226580, 36714326058265689312299208770046767978262537381409039227900064545582620789954275518777, 49604508510039968418573202206585737181507385927389531967823195875768692254191856613886, 37719045140223951527155902248585168046121900560176880148198957450510358807799836508706, 203845972808840257888877915864744649103677047305127051755716191788821084681463555974, 60034402667681553804341684034021151471270456256107775227478606280518778083624726703321, 50066635671952588374819144078955986656642383046175195995413332727920146328891027150003, 47201894966476559425651029339940746908655682556379911452338573155364379681619669558045, 57736611841757518261291789268588337456942002635719059798624961990343390771448065868032, 5242831458161354855290122126911458283660894473871776582866891448460558101051473086316, 17003750639400409606638700522694210383261898564008943657376475830781342269265138296960, 25943085190253630234132194653974281780691185411359653661401488717480005264708148229338, 50811080492727283608272497731012123340526545954894674792323942172295772399196808714020, 56318413948756343384812136970735720066596925049990901140433948042142606074214922725420, 21486529369688983977237091412223335956416834663914952831004870518202401553954630551621, 1012679942055925219083650927103771352413407208940904845271071891043657835731041281490, 5609385259145868467736088108827377959718271118195393746846978641916504637291275072988, 8729063973772968337935172058800488816100735730155547961442704516287496890025143940195, 26639283096542585913213481430725316018796638022326388551734527828512725246016230402706, 41020980788624234011388492323727559943750718216665021323971222429728208836344844919701, 51790463157328367183323338206362183154153654249497449562527010827149807204834213762563, 55983768966757332678155736887066025304263649357054853785418269105092326303400666871500, 53092899650533213755255277627398216603003983368970267533268221171454334105346013038023, 41631062064560828951492294032105013966707034110686636515479667479148463605453535612048, 21724293613533842505777381580496213309740961534587834640875234814195919246435415950808, 60130426463677153491234052413179279639302727443847047168541856088144264207131783587605, 6043416368515430816018221591960570166455710371289802212765977280888401869769663265494, 2933453201922336815483824979804210342248392548687707727344099881555571481890369556902, 22214389556546903317348085943087059573726704190153403714035718191518639714220133275808, 18337144967628781975130092987828431116133965706168204325549022372604599923339130831407, 12960568339021383970621359070830962381383091354609381398997979609988795839610502223800, 35211753407640401956538380175380472342174194845236109208902455814375423122095643008713, 53013115662269949799228916614009769689762058722390821021143089355656733812733590496128, 52871897916596601618700337451233122333895309296426184297451745524728607711927724375514, 61048994366934847092838146566213700526207152333930694450162855531844299385939413479790, 21839605017425363095735665333625039850682455495270770697384118072156672553644414461424, 57594722664266604942131630278737944125280591321572451203757619361748581765070482709135, 18457620442588297120684316274389543999954083462238708168971015555825621126168256709116, 48229241180647613833563675812273888910897471970203381304932907336344080539546525127166, 16162325931785677416826874826662472800021702263403949679389165508620805513502014100097, 12101814175796887127261740011690454906994077875122829735465441679994685973556215391766, 11796870924145085946035179511721806259278305330872860768184238713221266006381268763934, 26448257861338379002108056485186999070210335776716802140984254537654342629223658623462, 2004001620163102486119380772299783235352047909132161037881290597045451364713561805030, 3681809612291584226424454706546658766488258270956237468723162941044777882211445124393, 1338988912740811331105973856954809421751744987877723968692677491191845870683307986805, 35056426713023914457765557785320123823184944498589465877631711599413270883913337455756, 13102968511604066579420446007094776237841271633561713215908796674685548987192545123531, 31828134445438089747841633665817512595774568591567137327865483416334292168688110071140, 15761513784747457340961184106846288439948352376635891982191657839647344096047615367973, 7269593836391674363774236161527748581611731980384869195356115462426533687372999119448, 38026966452307043529569396395927768231867951090315569097213803833293530331980155577535, 16549521724108115671901913087981914024317098473342416329274167738003076075026441028318, 7474748109618482148790499589145437021803734417879017948776871649313907178075278974850, 7281109888992595645346073113289193007400820090737755161862482545048911083404716312954, 59754246715259336370887076452866296220798483181805200218279899156150146673001941240490, 25604285555945957733666162137766119829824130445486211249187998311517000088387025061123, 589048959577588263616014520952912351926119740245909814053496707346328755564998881772, 27881345484478735528891690914256866246754506965494055583966278958748945472927259444175, 5172110379837831478115608514623187627958078642734202912392150903142408206630871504197, 31297919040164050383398514074077545699599607952367159197546412121308978917146243517724, 47226883286838454420707480592989048449448953786653300430356692212931820610278749862736, 13522653533789428514134447576787070694649161090227157946026326305383800741587032971276, 41967104952823845395062890721775417031489149916362287805155540442303880287730695901298, 10550570222738957515242356043416613321051741546736542565301655682120367076216842824479, 30780540275771228433070598490492698550327533974418059837786887818464190298108192969524, 57282983421657194334134164302872236431151427890989617411288799997126632401744838076741, 55602295530870201406247563575872978217125184037964100715869066408538466611011340615310, 48673546794291406774367364066821442374148094201408880942133310150032358306964126337890, 19650352843722601207317918302287096891058606963778222953225846684438599509735295441949, 56537079069763396741575805396313753292825519632657199932896078644256094825134547992972, 41164709467322574523073646683691380988527004590418835463358552698762958556857384145492, 15306949729618695973280284464603990557435603888691744982467607257512984785296245125505, 7989328461135478956157193495926599198166904829014870813387247908227499426634868361008, 14302463184575252586627657502153625686499201098728406520105876545744804711294138890187, 26098027251143550377050964858665292533215605491812568780746246357318537579145020192184, 11517957830945372964571278354907636494363863092653931407343593637107619282408838796043, 42109759118683900905954373092298651613621567490552823447140172776722791831375038138560, 29807295012146847196418580705250684125102986753024020665379325627290746482328232989812, 29869789679347990100301951316985936138974966220849509661040508795433509857557875283521, 3126591177602876480462215923690098755547244242360600494956408546543867865096822311651, 15617002715439777515522320353917301312466287906317721472993666946736033244418445271189, 58744821296090568792925455058245401965696216356367078435899771088629869579211388822004, 23863124139755493924930902139152426086567003399654227603035000567689540607028317866537, 7190679550245041474347279796200747356580028955996915966728530843997001525317351769222, 37413559331372514521324897073961245668411396449290753974022166577762503501555439298147, 25387367754496011529270676589170636897569289789318434392961413391639563727937244886017, 27822615822981442163800239189012479714496733045926838667781903784036265272920247135665, 11591908592844107087927825930722676377181097830502015923749951274039155975820707716096, 51805264266954690601290026208390908099032786028545132414565645405131763412405321274840, 36184164251121034957182808886327967306263133222197339714398913600428388723796369346252, 17695974092744701073976654933461308293575867859468511491862254041348940477250717369652, 30007908281912189733646286321716014536468419902400406845488698221266930695587569851399, 57633861765032456187143734417733803503125622758341538882132404859026219549802313338437, 55945937911459653093944758581727543935497284593989767817979004963778419449032137082858, 43788318551364484800727614806895517540233694213538139755144122694757386888323183501693, 11751353383894564274556893579309854597991034196947035982401140797733127854712348980067, 37791451372402402989168752456803288969563985050129063289512297504151080723714358230696, 50948977377928232387138801191546037214121483558043520759997664458804798012927482110171, 18448220985656568765053861323847617447329299705568446302336477448105922064911525827721, 61123541546764369773190690832866202869882667693091239660493494338760055873614758345673, 28885601423414545732588931636513080929159122679158443697574141294694217387026576995057, 36615907729409702076826019131564642649982488888035046987789236805824744127873696729104, 7292006006378466490413229499877426625299939883193486704564408507917388215748234480938, 6372700871154141849801113513573963123911121115255058361183488584129301424584346016571, 10313850449990890839200640083663288157931891856062891317322058396799884963643576788386, 39810071393313847549789141638678536931827869831317080854883891887122204432223984044840, 43798199912559323288450514104913328923400855501024518742588133094446648942028921743551, 26651560841037453399004831414425645186259320975524493589109381034057664288483641286809, 38098532696726626705766042588252151755837680793035453641145365660724399927471388381867, 9780294846929283308688801592165376366652765160300109403445581807174017907485028102837, 10010535380076735687364729817264826293202274439236222309993069385360284976858016016459, 56387546624069421937430235994781543651516306281477055042348148799810089156277705251852, 23741847950634175940609285225019585265829157596771168909033963652130599220674541326623, 50052386704549283010718033261724830145643004631711904658241844231124897882133644247225, 23180392337470087632802278699953076685271444036436070932318866837366561696393089832622, 4710516565992435780620072230116806653946607549972952889950085537350710825011259838019, 55497437536680828618086394720424275561198087912516149144481198813178189332310751803, 41299940991910033694206551357880572217553215976033976081048256920879360391364362976067, 13530389224816879043183365507793844659866861568780905281276284532131598225086448233930, 34617654806719518746281007468075648581461677450696663009989724216107056870324194857193, 27644334236804958749487978438721340277673067099789187851732648490574505494038434287721, 44140028222280292607978898672512962001704255859777286734409816761814309932935979649089, 8603421941541131187823072034147262328017735353790730812352652956082509486213405751521, 61979788192187323622707546845466412805465534374665667562083565961242656469078929094399, 18989761524658560334217880654674259809178041265374897113753942721789405732881130915978, 27041039782159730696237532262056540912373241048026397152179871509626576076399318906258, 6439063799914555712535569577881337262960336029986662488226928773183625576392160137132, 7840747667542644639071918213253612562691476851960654242312865298820607562406095527496, 10977340504933468309704485612915914280196869476508159393421975069329112785049250723464, 57962293927055943608626867290993956332920043588665537076899529150285594277582805750256, 46106715246964766006932105916999504476916297249890012619361090200424113880444441049467, 720717261569370997796029796634050588796236466563298483124772371842743139482743218979, 44234401307164946593724670553891000587298148607434931379244510218377200367757950041024, 24376676869648816123735441108249227103340111124995872281579979305836568387939016333990, 26927047383691165573239087723268522984508365183387114312404979661235534207885007164184, 15241169401454091685155246023268664626432809774594566887110157579784240544391325479329, 12155894993339367001545940739434303895993652724202673110191166937585198340341836170162, 1719388205834932832504492397121377245250842629540696808311334616137021361127807697313, 39435471078302666707071254609442305359062177807357534604558017273970444560667167580004, 36522372015167018838512505576917207074625040659993290999047153510701588860212473134573, 45227517590536693195207204861196439104278511428524677493483123345027441318183091755572, 12657096713053660854594029827027600762789325896846779699886120815548003517085143929011, 42969271594433573624760384752552996666323688499011571446723929789391122011978814762472, 4523814308703439904489753997235458891243781461582934287591963916024249063297431640294, 22025563025444131054891516786293671035383627218572799441517007735383459576055144038585, 53705907796263613777081808846225326056839278718906810869183443308897839797647541653718, 60376271619700758135830348414714334620535860273265451069777026900956080780998977842312, 26856168103090883436562592793489742094034928240427569421162529341528433542483453823398, 27033603414845512932882364479946378704878280073728988181144615162111900936675385235684, 23841797095782781779566385586972340885626177100000126378968126555374941206644007425680, 22489754927923687770285868422393118436695610304990241233589074000031980472120292598098, 58778798555071893069241013377284612967349497017432524784674296586572634771367506341842, 22957843362390319522108151511410631945009728965268278968559262149155533491238045753434, 37435147965879741705866525123004460800811172045237673645386376798272356969818051134280, 4837381380865431344572854861308304859413943833215685658064514431664800583121551899498, 41699791373288532454540527108598406405094160598181936641267181647985791266640963667778, 35791676980261163144381974960601190908326175441856530094561482085497913868630781306978, 6295660703256991114779204652275184766003422542178655316347069377162960952640601322664, 23319510827406779969341929577776129995966138742018120522245298645579879313430234502491, 30499284429011462507689473813939252507432917501715687268714564977603158207393051459584, 52590808056554492462386491314399939110636211641519371781934453626128532919988599502020, 15688577427366795294692517861797296829680872985542746139072800108545160412348092512713, 24454968474324822703918810941264790077696858356703402145778660327250108762597844660730, 45960198437441223437531247189842087592007499066508162153184515179126981328747925544692, 17481615780582954559187725753090089891207770724331494886517731095113267593186975519992, 50198335666583450898693441844380194334308388122160550865670141751183293440437386735035, 17311823885159880517384751025956519592124211628080375281485952599534257757136497109687, 59280325589341172050765521808031759211310095238899216648519349917243290836795368388639, 48123052332380052339505826358833936352363423613369148222883340780684792120689719820211, 39727131517328412795354627109724708790191783139406001647077947489057332300232176503051, 29022095201490126614416190617566097921141435437169100082468788592412366620221149125684, 41873186819916934601021833348213971453423997530369770729658933609666681497131721558289, 1460600219226770907145974345213826812716324255039394975026395599514912954016914202513, 51936250235847985592337022804814084125610666214601079138062832590077350059406809151865, 27724953576048984203178292520079755139198413437917186210843568759513731192027201897183, 42059624240743744184228633175772180676234737633821654408398525524962831729151680770882, 53072372094304297666442962409494785858146082079496206438397878915443255514877510329988, 59773935115291963977316184645517443277544047741053126307180684642331822413746817374177, 59844921721226920536363203806273226760506865698494614346645772177526856635876720479368, 11224375841609470085332533790212570896751076502570757049751097848052159600832328684727, 13033986644334405018321083730497614143436787408108647900391143158649751677809488305838, 36755766164760771909528200800669376114880502951637369353146767803032650301479682374101, 25841552130108853088421337770069380180211730940888599154458384663561561818148494374461, 38494159902256706768908208686829060907149814197188836138862710072528970501593093180865, 57800241320618719962304185549239761885338896702251409017662593058594893609737095385623, 2774174052930294419131476335163995369594293477283357885772556969382772665318940351306, 52169273883654802975989561873557207894711722176127969470252109851147564337861088294107, 61137813057133063283721938608345530522412608781544852082668070936991571455636541523534, 8097726593697416112843133250183714557842504676468698062358559509532910659816443030570, 36851924487600244425601486679298863107293381736882591844655067090592662153499412432124, 32532653725281692706906597940023063821932124789071945377961896380400855211544902170129, 23712829107151991656224346222193710226377132270772166916934993795512190084597873711358, 29051450783792895586287235766552420779590232710043644309976847073355812550280632592177, 4425904501804598770099702786594268550686457956417458121303598248568642163145829507740, 27459838774732560624833325035831378992280738278960264629374069352418680293891022098489, 5790008141942893249371509975039075957614572470946724267487298310515498854942522784184, 23384469777204002447515365119877912004036612681898849961271304808646713833606416118409, 54799551957145134881852478844437235514594411614237122251934176537044914655691004208980, 58071254777103542304348487769051976129308667522804573744427019764236561083005559170407, 33617370947581974127107454903262896430882971609611526398113549022846506183801015995191, 61576134613932731726897568166697090537883993560019577187027299525032175981948152020341, 43769913560145290370737254885168120726476505397358048333194200949952984508312630226936, 13733738589055198930833528056872357505548548283182773160275041880017156927946476135564, 60540164836217290103370684386564190446994470647806840095988866869905807800278161873821, 53149921387836621618573696102647517163913101120213267316407942181938522156498783947518, 60901108352438580532747737009821681637803778570738846730573222744696891673082149691187, 48774150287078885256657900027246843853820319287736128385565381936226265820089630206779, 7774258809160209970376039153653379244624610594757914859306980801246900552073138277350, 57793684165461551850210018589933660293977094223652589136920057563063577889867320594389, 53386234151461184805041784874344655863680441751772553068248911486381411252426783933614, 1403568164480229554460835797136454152989481502814379645807224685333097035715722607693, 57676590850463930114850855309155101242228472275533433220961241474336622535427801132913, 27529603873424561987769551710059311138915554142390315956296834888521263052476998013157, 39514627537373564420152937700771090617000606181277351267685939010238482371691361225522, 61412721459530623432482870699059756415458579122207463350395628051715148867624895221950, 10241451793146041086633028909852521208452980457325061388441665208762844778606351819044, 44294742244955162832685746162982741088067414023455827141369893584176800277880693796974, 7833490678060157284017583721498402730729393754476207301455598608837352235050355141614, 13667647436311292600858459955008928683940210436931466782140526974244692555144154778265, 19186551410081284763926750962307846608907363363972029484433786952444123248740599576396, 16289783212447411974594680684279216937992319803412881287707275064113853613798051411057, 26348970099026653812621811675961628931001621671880826181878314337058190753625842387978, 46230231271758982760804157399116602414068371316725323710125347042357227124092179176744, 18571357298754131366875840321503457730308296406486134007116233253095546519037172108456, 56008286530218410409795046760561434654654986195788120770207638215936841630509771376037, 31246192676989587945535808704245682760226880272276911098245859630527247213233001444799, 21338280950756897687856268370573441573847778880191184956474787940629761766594348960110, 11665111714362992299370542345192032341403218504789758223742170797918382647362166339954, 31804897936525300144499036828781677554434204680505698835120724802863001203488534684076, 37968665595652710791570932194899500735248822820081022033711350370281943264167090817370, 37071374153482442215478528303549313031150249007510190850611317084583028283621406603360, 35355490290524379572650737110129173452800718696166381142936447115259394143973306440403, 40275129060982105159232727903861653938095352934870073240608552106580349464147622256871, 15358678990766641941895525963101670999880045011210473186499585568618940520368050216585, 60360501845984520514095027259600482999334818579671515098227880813483204106428651104339, 36510150691106922809808545913773901759924358965544842813798148746704149043306651382848, 17062843599960002389964927729049568337920456626823683456699718317693772683009889275216, 17627187047634866673021411113041919988648994018810686903676834109013105642234772920622, 17320280558957889865791628745063305658352129163552521803184919243742154059692151971475, 45297169477315671844730673229615938018172229368483786098999297234790490075506719515600, 25021995392460840629714064283569734146019309266880756034056588503597831015020738277419, 13174579180330604174242220889065958381594821510996556505734092549996122984329582065628, 28031206791603257345815191737655446964214981794751532258803025702725595092186329863808, 42899029296528215555194530600771629908888169373938815655493669197138254446277552242442, 20675635010555158383647509416542513233168431342588096879848678469307818013259187662450, 60245938419745999882948420364525949335936487188126957984674014538646729446775437530337, 55546927345957116623309190419572871620864116621967170784125776434096554554171370681052, 8118780664592805319953071790388633345454091460600512672667459508090145734757992894862, 54301818967684121423054124530287366494011708629419113080310219375993882841458717909524, 16274037295296610479279684369673979341459631818427104756754372287324127243384112802963, 27890844069690572218209890416128877075597061880721809720475790928170357736568363625970, 12741613596224959145929637292335964631531995847696382032723946356226435301423073662195, 32607470968583639618990327409684454255241160134696872813720177761298558323567849266710, 58569755640140913467870588180039213050465604715683299925628504393559347312391966241943, 33773523803356060143794491079666985472748567325827989382981398564346890073305922275764, 42185942299618595517075815561999662532385007574718063859883448586943891616153780447028, 50733940383808057679710491502966477803232218441583428279767519868956866754122183617121, 21023919674297276866627835205160087740117334576722294213877227244566417547234189022209, 55290528861542549823924096367956692564742216454652090288049712819094082312279015533018, 52975877808531145852336285548989301183617796664957674451179000882174624659998458707985, 61560014678845577755419119390919015301467857037308616065902265326353823254323127315094, 60268396810460446578225596813580905667516152168597808117955065095108673355792862752027, 34657924279680354637273247399770587981306097113530324689804817950412464101152916427557, 61133623735515332885327118325631750514431568538698037973970672988282062110466086856328, 32954260988402275563068723480208916496561194418522252988345680552055649820329741489877, 61488969757035356481716566864475324816983815574192726179836089227713434519173143166500, 56359869276650040966162953154432377325962000970848921842290698325876367454984669714796, 5542745147026315851613470243502739079911638819744111588216266757583892956249128886171, 26473201440910607724674454006620676867231791010328775664461273605479747103755800138355, 31564431032522294172557695852314437176912458101329966500128882059031093415598614343845, 37423755869327246113687710796486468384724475471043310871412023918469861969224146086791, 41998858293994921915340715086518880252886154743281582046471411145611132169453029439848, 13950852837793942645054774889646099774984768133673064971697918287183850692918062755433, 34638674054457954748505874496939601422793787179471118556967729028771100031305174099284, 30065144448572078516171533314550117815736888647075907466053237850849206227321779826985, 53486657604867681456850075102753467661591346886045922454046427203112840534620084711701, 20066223104334417552368460479665826117697937871008868132687637104783276828628527056848, 50938455029466300504937430070495913081553581505565458782810556662487651023205754121780, 18218520233931098616199352822788223886858687589237755849615701630943635368983499197917, 42223073248978205667168446190360610560216189553835385323666273937578381050054679136069, 14831082919038617792567234032730760189859224373927816914446115995744164606762943223939, 18699872269750417725266020155777050487418002882195536591619426856802944724147277831313, 36443402717544504210335109779547804981213417040712518067737480300675697276127451505406, 20026567699778559000384347042895257519884110368108170429571242802618148297499757616828, 39292400759721037457864603437895809852008239020112690497111801050564070457237796973957, 48609150014233729093349254512792465851082875969744562217997375195830779789080768497740, 31501118138340168172078778375885756232427639634098140481438682434434643587261608603156, 60634923070880754291274833678619091714184054436765366134382245076423207396451876470368, 6362927739022796901295366363252255680118131280055760903051731459175638999545821027668, 17175391324716789821381125999397155054127713533840156593937977943676539994670038103141, 30668561188699527408546819295603570981855413879628276495286720344676359698176549692011, 19848444016356582558753652595031605077083404124674675346229231000539198204097248169926, 20374756428222374940970696808250867729104948053932944318461951886903399512661630906375, 40413420667058389998765905473092240742175043406796465353707372240824642948191045296775, 13576188260198878605151165130817216410117887849353707113745282746772531303200297608825, 38928965282893802770802407029011196203066026928284609081955369587878808150201027484408, 50141036547360941340894202870350521135014776807029377419068032437812960383551402417362, 8406720489374251485005400296882825269204164564815195875952580599707795757108563327506, 4197559872564347841252506118270677010539126291697091005227414303175818829952129885119, 9395130926989099019951429772804838481000464194274000405354997735548390643663334754497, 21721055368729834768554604497647037700691796730783998431757280087652516896011300724999, 24440182885522218380038500817024366163092029954067803412923677454798505209998692174257, 23507757166134515344976323038535327556093471347720324726935142873576046035399736657751, 4632155182778401572590898595583660210897985105578493927536198875382150560563388745900, 39772529318497983717072881587671864599457575748024191351446394842319593733642956208119, 30437694060758682052196196907637802306775290102964014881534548781239748624736997205177, 23786412403332186628410271144391375379158459257599034594260453033798750512699417031142, 50140993375430928763078318621770368731949979261626827649091315365559755237086544030845, 47709648876585337090978476264397197938011839827670397228242683258502923032037646049024, 15602883982742873929335006209314488477315803680846541293030235647124002427754599104017, 45280393728951387611117663939324224257297470048958485741361996990905497875681068376142, 57540599362827901609082936607271688126763047376101315951016157787306276257993022687107, 446041756187034731796183600090839664367044000970986993511824695655775154152026720716, 17207393505458204381844699621729899806824665949994050009364716367089865440826339242000, 13655994993025759505238093032658735091511179661460067363858612982345542765251712952094, 5448467727024049103085331379131070075175704603370799379947468536565148381117807488869, 8585353569904189133089031525611081479857199158767217412953529866977640996642656733445, 40025888855199867884228967992629994446968553365400087481750649033140866755945616293624, 56492562129062886727355470112487162718647769563931379644793358200474411629391287539089, 34843262452412047849367066985975517929095625595959168656601386247343772003227224122552, 43472292688262791304286770422789809165226634904496613376890702032659089362442099687867, 28108870043768408366621723183948679947139339288166921671733191680242087761311094767506, 11860092646620002188711758395647937618195956146414373772971055491353372466474121971706, 50182076716493531991490169840926807501155708042368759676546525605562757964269149524473, 20158806501427016701277032988835220082317061042791783693475244059525140059223580344871, 10906348548153881372322119378839455492186759765749667907782122884398917068628114232836, 17883843633036348010935051913529460830448034777773871449455789767144818589334545806369, 43641909026764239160679603500912320539043859012239766645295333215024739647563248113766, 17811317689552543151146426942262816178909705734396636836771269174155564199312301843463, 4268895426070739086701460181999537234991159740305384564711061096590793222513955409129, 59663916901409855870525776251750927554382495008651376568169128816272531514063684819919, 49785282927002529597846208139824316276055935359746458422088154333398775682679211445967, 18272873284458123079383944887037566475069217942761020175398035622914974165856862453482, 61870830380702953483316087293568067010715181006520236043899379798938564802885141479294, 25249856786817927558900924893222488192657655286062668931777467386785708851270683126549, 36421987379700451698202120428765954664946364148517854002198139880469718188116864499541, 25576537303840822838914957090627185045497722426577577911567830916214528320779028728686, 9778226290758212397709746305894057434459717166840125068605958133356356063102137000424, 28122448653574900115388230742524740444101668679636502085203071302995928401879570028839, 25649438823227023978302326420944776219296934264042550451819812982910685314474572781300, 52986133545590833014706786644105933409879534960900382090571553443816529494830443286878, 4365926893046708100746769103517215948737335288905734292256672011713857797237484505675, 19017991403846416091129668449002223588062320907194545883131061749720121137626304877971, 22784701079299378184061531498711811645369112601131546132608596916712991157766440175483, 4022511320837068117151240260521597777929807139640896922787608423186138691601715229435, 47633804623803937111516510535752429675078590053963940214104638264486270365424656317300, 8905106153912819265930295910495192384806802996782398375282219995540706642696599777262, 17218514545115032883901318973151469572326189992018121232027774880615866622056142691747, 12141009964798632014868554985902271561652565922887513643276231680649427780830762177378, 23050892278329442825512503955464957953213174612492874728014916308906017677408172407680, 22564022078367679183538556138282392680731851229496296642914777305202960191437086384753, 33766230689170670304776831794171884225085416600985499359171340336183006959709744990235, 1003224574318836390916037938116685726518133030687840972457966531788921640943579230529, 57727426217391042242069278864279411759641399690733361874342894904779912585697146562799, 14418514064236263180532416987880726815963677820125524758404460840597620976392172017890, 30537358294095885301649532337156012844654246000941721904043153024204439209542957854284, 17777662281041808896529752305918035918475001875820511719086869296564920052586999882578, 29202616590531416733490202288646484129369661216877223877720060827086488639409524318554, 47670113578465654035010280027746524149713635984846572400146540482880881299646442070647, 18959898649460639462254582857258182743203119545929005128034326022519296081727139809886, 36921585211024475101980361950533617186951403966711300775389954657808183355063447566515]</span><br><span class="line">msg = 0</span><br><span class="line">for item in k :</span><br><span class="line">    if (num((item * G1) % (2 ^ 285 - 1)) &lt; 99) :</span><br><span class="line">        msg = msg * 2</span><br><span class="line">    else :</span><br><span class="line">        msg = msg * 2 + 1</span><br><span class="line">print(msg)</span><br></pre></td></tr></table></figure>

<p>发现对于五个可能的私钥G，所求得的明文相同，说明这五个私钥是等价的。</p>
<p>接下来通过明文还原出字符串。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">flag = []</span><br><span class="line">msg = 3396338499904625226237901301101692941889277720888775333117202235037768307561514099566745208246754901817510615285537379473280938109</span><br><span class="line">while msg != 0 :</span><br><span class="line">    flag.append(chr(msg % 256))</span><br><span class="line">    msg = msg // 256</span><br><span class="line">i = 53</span><br><span class="line">while i &gt; -1 :</span><br><span class="line">    print(flag[i])</span><br><span class="line">    i = i - 1</span><br></pre></td></tr></table></figure>

<p>flage为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NeSE&#123;r4ndom_partiti0ning_and_LLL_att4ck_nf2u3jrhj2930&#125;</span><br></pre></td></tr></table></figure>



    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/12/11/3/" rel="prev" title="大橘">
      <i class="fa fa-chevron-left"></i> 大橘
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/05/08/1/" rel="next" title="个性签名">
      个性签名 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="关子雎"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">关子雎</p>
  <div class="site-description" itemprop="description">思想不受困于天堂，才能自由于尘世。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; Wed May 04 2022 08:00:00 GMT+0800 (中国标准时间) – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">关子雎</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
